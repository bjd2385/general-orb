description: |
  Release to PyPi. Requires a context with $PYPI_USERNAME and $API_TOKEN set.
executor: python-3-10
resource_class: small
parameters:
  user:
    description: PyPi username.
    type: string
    default: $PYPI_USERNAME
  token:
    description: PyPi API token.
    type: string
    default: $API_TOKEN
steps:
  - checkout
  - run:
      name: Build package.
      command: python setup.py sdist bdist_wheel
  - run:
      name: Publish package to PyPI.
      command: |
        pip install twine
        twine upload dist/* -u << parameters.user >> -p << parameters.token >>